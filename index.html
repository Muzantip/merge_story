<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>Город Мастеров: Merge Story</title>
  <style>
    :root { --bg:#1e2127; --panel:#2a2f38; --pill:#303643; --txt:#e8ecf1; }
    html,body { margin:0; height:100%; overflow:hidden; background:var(--bg); color:var(--txt); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    #wrap { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; }
    #gameCanvas { background:#111; box-shadow:0 10px 30px rgba(0,0,0,.45); max-width:100vw; max-height:100vh; display:block; }
    #hud { position:fixed; left:8px; top:8px; display:flex; gap:10px; align-items:center; z-index:3; }
    .pill { display:flex; align-items:center; gap:6px; background:var(--pill); border-radius:999px; padding:6px 10px; box-shadow:0 2px 10px rgba(0,0,0,.3); }
    .btn { border:0; border-radius:10px; padding:8px 12px; background:#3a7afe; color:#fff; font-weight:700; cursor:pointer; box-shadow:0 2px 10px rgba(0,0,0,.35); }
    .btn:active{ transform:translateY(1px); }
    #panel { position:fixed; right:10px; top:70px; width:300px; background:var(--panel); border-radius:14px; padding:12px; box-shadow:0 8px 24px rgba(0,0,0,.45); z-index:2; }
    #panel h3 { margin:6px 0; }
    #quests { max-height:260px; overflow:auto; }
    #quests .q { background:#1f2430; border-radius:10px; padding:8px; margin-bottom:8px; }
    #quests .done { opacity:.6; text-decoration:line-through; }
    #log { background:#1b1f27; border-radius:10px; padding:8px; max-height:170px; overflow:auto; font-size:12px; }
    #hint { position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,.55); padding:12px 16px; border-radius:12px; font-weight:700; z-index:5; }
  
    *, *::before, *::after { box-sizing: border-box; }
    body { overflow:hidden; }
  </style>
</head>
<body>
  <div id="wrap" style="display:none;">
    <canvas id="gameCanvas" width="800" height="600"></canvas>
  </div>

  
  <div id="netbar" style="display:none !important;" style="display:none;" style="position:fixed; left:8px; top:52px; display:flex; gap:8px; align-items:center; z-index:4;">
    <select id="modeSel" class="pill">
      <option value="solo">Solo</option>
      <option value="vs">VS (2 игрока)</option>
    </select>
    <input id="roomId" class="pill" placeholder="Room ID" style="padding:6px 10px; outline:none;">
    <button id="createBtn" class="btn">Создать</button>
    <button id="joinBtn" class="btn">Войти</button>
    <button id="readyBtn" class="btn">Готов</button>
    <span id="connState" class="pill">offline</span>
  </div>


  <div id="hud" style="display:none !important;" style="display:none;">
    <div class="pill"><img src="assets/energy.png" width="22" height="22"><span id="energyText">0/0</span></div>
    <div class="pill"><img src="assets/coin.png" width="22" height="22"><span id="coinsText">0</span></div>
    <button id="spawnBtn" class="btn">Создать предмет (−1E)</button>
    <button id="saveBtn" class="btn">Сохранить</button>
    <button id="loadBtn" class="btn">Загрузить</button>
    <button id="adBtn" class="btn">Видео за энергию</button>
  </div>
    <h3>События</h3>
    <div id="log"></div>
  </div>

  <div id="hint">Стрелки — движение со скольжением. Перетаскивание/клик — слияние. «Создать предмет» — спавн за энергию.</div>

  <script src="sdk.js" defer></script>
  <script src="net.js" defer></script>
  <script src="quests.js" defer></script>
  <script src="game.js" defer></script>

  <!-- Start Menu Overlay -->
  <div id="startMenu" style="position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(14,15,18,0.92); z-index:10;">
    <div style="background:#2a2f38; border-radius:16px; padding:18px 18px; width: min(520px, 92vw); box-shadow:0 16px 48px rgba(0,0,0,.5); color:#e8ecf1;">
      <h2 style="margin:0 0 8px 0;">Город Мастеров</h2>
      <div style="opacity:.8; margin-bottom:14px;">Выберите режим игры</div>
      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-bottom:12px;">
        <button id="menuSolo" class="btn" style="width:100%;">Играть Solo</button>
        <button id="menuVSCreate" class="btn" style="width:100%; background:#ff8b3d;">Создать комнату VS</button>
      </div>
      <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
        <input id="menuRoomId" placeholder="Room ID (для входа)" style="flex:1; padding:8px 10px; border-radius:10px; border:none; background:#303643; color:#e8ecf1; outline:none;">
        <button id="menuVSJoin" class="btn" style="background:#f0c04a; color:#0e0f12;">Войти</button>
      </div>
      <div style="font-size:12px; opacity:.7;">Можно оставить Room ID пустым при создании — он сгенерируется.</div>
    </div>
  </div>

</body>
</html>
